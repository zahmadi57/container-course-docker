---
# server: nginx pod and a ClusterIP Service fronting it.
# The deny-policy.yaml targets this pod by app=server label.
apiVersion: v1
kind: Pod
metadata:
  name: server
  labels:
    app: server
spec:
  containers:
  - name: nginx
    image: nginx:1.27
    ports:
    - containerPort: 80

---
apiVersion: v1
kind: Service
metadata:
  name: server
spec:
  selector:
    app: server
  ports:
  - port: 80
    targetPort: 80

---
# client: a curl container used to test connectivity to the server pod.
# Use: kubectl exec client -- curl -s --max-time 5 http://server
apiVersion: v1
kind: Pod
metadata:
  name: client
  labels:
    app: client
spec:
  containers:
  - name: curl
    image: curlimages/curl:8.7.1
    command: ["sleep", "3600"]
